{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\nconst API_KEY = '44794510-78ac4561676a1628ffedd5f1c';\n\nexport async function getPicturesByQuery(query, page = 1) {\n  const searchParams = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    per_page: 15,\n    page: page,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n  });\n\n  try {\n    return (await axios.get(`?${searchParams}`)).data;\n  } catch (error) {\n    throw new Error(response.status);\n  }\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst loader = document.querySelector('.js-loader');\n\nexport function createMarkup(hits) {\n  return hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"gallery-item\">\n            <a class=\"gallery-link js-item\" href=\"${largeImageURL}\" data-image-description=\"${tags}\">\n                <img\n                    class=\"gallery-image\"\n                    src=\"${webformatURL}\" \n                    data-source=\"${largeImageURL}\" \n                    alt=\"${tags}\" \n                     width=\"360\" height=\"200\"\n                    />\n                    </a>\n                <div class=\"image-info-wrap\">\n                    <div class=\"image-info\">\n                        <h2 class=\"title\">\n                        Likes\n                        <p class=\"amount\">${likes}</p>\n                        </h2>\n                    </div>\n                    <div class=\"image-info\">\n                        <h2 class=\"title\">\n                        Views\n                        <p class=\"amount\">${views}</p>\n                        </h2>\n                    </div>\n                    <div class=\"image-info\">\n                        <h2 class=\"title\">\n                        Comments\n                        <p class=\"amount\">${comments}</p>\n                        </h2>\n                    </div>\n                    <div class=\"image-info\">\n                        <h2 class=\"title\">\n                        Downloads\n                        <p class=\"amount\">${downloads}</p>\n                        </h2>\n                    </div>\n                </div>\n        </li>`\n    )\n    .join('');\n}\n\nexport function initializeLightbox() {\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captions: true,\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n  lightbox.refresh();\n}\n\nexport function showLoader() {\n  loader.style.display = 'block';\n}\n\nexport function hideLoader() {\n  loader.style.display = 'none';\n}\n\nexport function onFetchError() {\n  iziToast.error({\n    title: 'Error',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n  });\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { getPicturesByQuery } from './js/pixabay-api.js';\nimport {\n  createMarkup,\n  initializeLightbox,\n  showLoader,\n  hideLoader,\n  onFetchError,\n} from './js/render-functions.js';\n\nconst gallery = document.querySelector('.js-gallery');\nconst searchForm = document.querySelector('.js-search-form');\nconst loadMoreBtn = document.querySelector('[data-action=\"load-more\"]');\nconst upButton = document.querySelector('.js-btn-up');\nconst hiddenClass = 'is-hidden';\n\nconst perPage = 15;\nlet query = '';\nlet page = 1;\nlet totalPages = 0;\n\nhideLoadMoreBtn();\nhideUpButton();\n\nsearchForm.addEventListener('submit', handleSearch);\nloadMoreBtn.addEventListener('click', onLoadMoreBtnClick);\nupButton.addEventListener('click', scrollToTop);\n\nasync function handleSearch(evt) {\n  evt.preventDefault();\n  gallery.innerHTML = '';\n  page = 1;\n\n  const form = evt.currentTarget;\n  query = form.elements.query.value.trim().toLowerCase();\n\n  if (!query) {\n    onFetchError();\n    hideLoadMoreBtn();\n    hideUpButton();\n    return;\n  }\n  showLoader();\n  hideLoadMoreBtn();\n  hideUpButton();\n\n  try {\n    const data = await getPicturesByQuery(query, page);\n\n    totalPages = Math.ceil(data.totalHits / perPage);\n\n    // if (page === totalPages) {\n    //   disableLoadMoreBtn();\n    //   hideLoader();\n    // } else {\n    //   disableLoadMoreBtn();\n    // }\n\n    if (!data.hits.length) {\n      onFetchError();\n      return;\n    }\n\n    gallery.insertAdjacentHTML('afterbegin', createMarkup(data.hits));\n    initializeLightbox();\n\n    if (data.totalHits > perPage) {\n      showLoadMoreBtn();\n    }\n  } catch {\n    onFetchError();\n  } finally {\n    hideLoader();\n    form.reset();\n  }\n}\n\nasync function onLoadMoreBtnClick() {\n  page += 1;\n  disableLoadMoreBtn();\n  showLoader();\n\n  try {\n    const data = await getPicturesByQuery(query, page);\n\n    if (!data.hits.length) {\n      onFetchError();\n      hideLoadMoreBtn();\n      // hideUpButton();\n      return;\n    }\n\n    gallery.insertAdjacentHTML('beforeend', createMarkup(data.hits));\n    initializeLightbox();\n    smoothScroll();\n\n    if (page > 1) {\n      showUpButton();\n    }\n\n    if (page === totalPages) {\n      hideLoadMoreBtn();\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    } else {\n      enableLoadMoreBtn();\n    }\n  } catch {\n    onFetchError();\n  } finally {\n    hideLoader();\n  }\n}\n\nfunction hideLoadMoreBtn() {\n  loadMoreBtn.classList.add(hiddenClass);\n}\n\nfunction showLoadMoreBtn() {\n  loadMoreBtn.classList.remove(hiddenClass);\n}\n\nfunction disableLoadMoreBtn() {\n  loadMoreBtn.disabled = true;\n}\n\nfunction enableLoadMoreBtn() {\n  loadMoreBtn.disabled = false;\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } =\n    gallery.firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction hideUpButton() {\n  upButton.classList.add(hiddenClass);\n}\n\nfunction showUpButton() {\n  upButton.classList.remove(hiddenClass);\n}\n\nfunction scrollToTop() {\n  window.scrollTo({\n    top: 0,\n    behavior: 'smooth',\n  });\n}\n"],"names":["axios","API_KEY","getPicturesByQuery","query","page","searchParams","loader","createMarkup","hits","webformatURL","largeImageURL","tags","likes","views","comments","downloads","initializeLightbox","SimpleLightbox","showLoader","hideLoader","onFetchError","iziToast","gallery","searchForm","loadMoreBtn","upButton","hiddenClass","perPage","totalPages","hideLoadMoreBtn","hideUpButton","handleSearch","onLoadMoreBtnClick","scrollToTop","evt","form","data","showLoadMoreBtn","disableLoadMoreBtn","smoothScroll","showUpButton","enableLoadMoreBtn","cardHeight"],"mappings":"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"}